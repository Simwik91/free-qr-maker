<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <meta name="description" content="Advanced QR code generator with custom colors, logo embedding, size control, and bulk processing">
  <title>Advanced QR Code Generator</title>
  <link rel="icon" type="image/x-icon" href="favicon.ico">
  <script async src="https://www.googletagmanager.com/gtag/js?id=G-LR5XP1GJFC"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());
    gtag('config', 'G-LR5XP1GJFC');
  </script>
  <script src="https://cdn.jsdelivr.net/npm/qrcode/build/qrcode.min.js"></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/jszip/3.10.1/jszip.min.js"></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/FileSaver.js/2.0.5/FileSaver.min.js"></script>
  <script src="https://cdn.jsdelivr.net/npm/jsqr@1.4.0/dist/jsQR.min.js"></script>
  <style>
    body {
      font-family: 'Segoe UI', sans-serif;
      text-align: center;
      padding: 2em;
      background: #f4f4f4;
      color: #333;
    }
    h1 {
      font-size: 2em;
      margin-bottom: 0.2em;
    }
    h2 {
      font-size: 1.5em;
      margin-top: 1.5em;
      margin-bottom: 0.5em;
    }
    p {
      margin-top: 0;
      margin-bottom: 2em;
      color: #666;
    }
    input, select, button, textarea {
      margin: 0.5em auto;
      padding: 0.75em;
      width: 90%;
      max-width: 400px;
      font-size: 1em;
      border-radius: 6px;
      border: 1px solid #ccc;
      box-shadow: 0 1px 3px rgba(0,0,0,0.1);
      box-sizing: border-box;
      display: block;
    }
    button {
      background-color: #007acc;
      color: white;
      border: none;
      cursor: pointer;
    }
    button:hover {
      background-color: #005fa3;
    }
    canvas {
      margin: 1em auto;
      display: block;
      max-width: 400px;
    }
    footer {
      margin-top: 4em;
      font-size: 0.85em;
      color: #888;
    }
    .sister-site-btn {
      display: block;
      background: #ff6600;
      color: white;
      padding: 0.75em 1.5em;
      margin: 1em auto;
      border-radius: 6px;
      text-decoration: none;
      font-weight: bold;
      max-width: 400px;
      width: 90%;
      transition: background-color 0.3s ease;
      text-align: center;
    }
    .sister-site-btn:hover {
      background-color: #cc5200;
    }
    .sister-tools-section {
      margin: 2em auto;
    }
    .sister-tools-section h2 {
      font-size: 1.8em;
      color: #333;
    }
    .sister-tools-section p {
      font-size: 1em;
      max-width: 600px;
      margin: 1em auto;
    }
    .toggle-container {
      display: flex;
      align-items: center;
      justify-content: center;
      gap: 0.5em;
      margin: 1em auto;
    }
    .toggle-switch {
      position: relative;
      width: 50px;
      height: 26px;
    }
    .toggle-switch input {
      opacity: 0;
      width: 0;
      height: 0;
    }
    .slider {
      position: absolute;
      cursor: pointer;
      top: 0;
      left: 0;
      right: 0;
      bottom: 0;
      background-color: #ccc;
      border-radius: 26px;
      transition: 0.4s;
    }
    .slider:before {
      position: absolute;
      content: "";
      height: 20px;
      width: 20px;
      left: 3px;
      bottom: 3px;
      background-color: white;
      border-radius: 50%;
      transition: 0.4s;
    }
    .toggle-switch input:checked + .slider {
      background-color: #007acc;
    }
    .toggle-switch input:checked + .slider:before {
      transform: translateX(24px);
    }
    .color-group {
      display: flex;
      justify-content: center;
      gap: 15px;
      margin: 1em 0;
    }
    .color-input {
      display: flex;
      align-items: center;
      gap: 8px;
    }
    .color-input input[type="color"] {
      width: 40px;
      height: 40px;
      padding: 2px;
      cursor: pointer;
    }
    .logo-preview {
      width: 60px;
      height: 60px;
      border: 1px dashed #ccc;
      border-radius: 8px;
      margin: 0.5em auto;
      display: flex;
      align-items: center;
      justify-content: center;
      overflow: hidden;
    }
    .logo-preview img {
      max-width: 100%;
      max-height: 100%;
      object-fit: contain;
    }
    .loading {
      display: none;
      text-align: center;
      padding: 20px;
    }
    .spinner {
      border: 4px solid rgba(0, 0, 0, 0.1);
      border-left-color: #007acc;
      border-radius: 50%;
      width: 40px;
      height: 40px;
      animation: spin 1s linear infinite;
      margin: 0 auto 15px;
    }
    @keyframes spin {
      to { transform: rotate(360deg); }
    }
    .error {
      color: #d9534f;
      padding: 10px;
      background: rgba(217, 83, 79, 0.1);
      border-radius: 8px;
      margin: 10px 0;
      display: none;
    }
    .success {
      color: #5cb85c;
      padding: 10px;
      background: rgba(92, 184, 92, 0.1);
      border-radius: 8px;
      margin: 10px 0;
      display: none;
    }
    .history-item {
      padding: 10px;
      border: 1px solid #ddd;
      border-radius: 6px;
      margin-bottom: 10px;
      cursor: pointer;
      transition: all 0.3s;
      max-width: 400px;
      margin: 0.5em auto;
      text-align: left;
      font-size: 0.9em;
    }
    .history-item:hover {
      border-color: #007acc;
      background: rgba(0, 122, 204, 0.05);
    }
    .history-date {
      font-size: 0.8em;
      color: #888;
      margin-top: 5px;
    }
    .scanner-container {
      position: relative;
      width: 100%;
      height: 300px;
      border: 1px solid #ddd;
      border-radius: 8px;
      overflow: hidden;
      margin: 1em auto;
      max-width: 400px;
    }
    #scanner-video {
      width: 100%;
      height: 100%;
      object-fit: cover;
    }
    .scanner-overlay {
      position: absolute;
      top: 0;
      left: 0;
      width: 100%;
      height: 100%;
      display: flex;
      justify-content: center;
      align-items: center;
      background: rgba(0, 0, 0, 0.5);
    }
    .scanner-box {
      width: 250px;
      height: 250px;
      border: 3px solid white;
      box-shadow: 0 0 0 1000px rgba(0, 0, 0, 0.5);
    }
    .tabs {
      display: flex;
      justify-content: center;
      margin: 1em 0 2em;
      gap: 5px;
    }
    .tab {
      padding: 8px 16px;
      cursor: pointer;
      background: #e9ecef;
      border-radius: 4px;
      font-weight: 500;
    }
    .tab.active {
      background: #007acc;
      color: white;
    }
    .tab-content {
      display: none;
    }
    .tab-content.active {
      display: block;
    }
    .size-group {
      display: flex;
      align-items: center;
      justify-content: center;
      gap: 10px;
      margin: 1em 0;
    }
    .size-value {
      min-width: 60px;
      text-align: center;
    }
  </style>
</head>
<body>
  <h1>Advanced QR Code Generator</h1>
  <p>Create custom QR codes with logos, custom colors, and bulk processing</p>
  
  <div class="tabs">
    <div class="tab active" data-tab="single">Single QR Code</div>
    <div class="tab" data-tab="bulk">Bulk QR Codes</div>
    <div class="tab" data-tab="scan">Scan QR Code</div>
  </div>
  
  <!-- Single QR Code Tab -->
  <div class="tab-content active" id="single-tab">
    <input id="qr-input" type="text" placeholder="Enter text or URL" autofocus>
    <div class="error" id="input-error">Please enter some content for the QR code</div>
    
    <div class="color-group">
      <div class="color-input">
        <label for="fg-color">Foreground:</label>
        <input type="color" id="fg-color" value="#000000">
      </div>
      <div class="color-input">
        <label for="bg-color">Background:</label>
        <input type="color" id="bg-color" value="#FFFFFF">
      </div>
    </div>
    
    <div class="size-group">
      <label for="size-slider">Size:</label>
      <input type="range" id="size-slider" min="128" max="1024" value="256" step="32">
      <div class="size-value" id="size-value">256px</div>
    </div>
    
    <label for="logo-upload">Add Logo (optional)</label>
    <input type="file" id="logo-upload" accept="image/*">
    <div class="logo-preview" id="logo-preview">
      <i>No logo selected</i>
    </div>
    
    <button onclick="generateQR()">Generate QR Code</button>
    
    <div class="loading" id="qr-loading">
      <div class="spinner"></div>
      Generating QR Code...
    </div>
    <div class="error" id="qr-error"></div>
    
    <canvas id="qr-canvas" width="256" height="256" style="display:none;"></canvas>
    
    <div class="success" id="qr-success">QR Code generated successfully!</div>
    
    <button id="download-btn" style="display:none" onclick="downloadQR()">Download QR Code</button>
    
    <h2>Generation History</h2>
    <div class="error" id="history-error">No QR codes generated yet</div>
    <div id="history-list"></div>
    <button onclick="clearHistory()">Clear History</button>
  </div>
  
  <!-- Bulk QR Codes Tab -->
  <div class="tab-content" id="bulk-tab">
    <h2>Bulk QR Code Generator</h2>
    
    <label for="bulk-input">Enter URLs or text (one per line):</label>
    <textarea id="bulk-input" rows="8" placeholder="https://example.com/page1
https://example.com/page2
Any text or data"></textarea>
    
    <label for="bulk-filename">File Name Prefix:</label>
    <input type="text" id="bulk-filename" value="qr-codes">
    
    <button onclick="generateBulkQR()">Generate Bulk QR Codes</button>
    <button id="download-bulk" disabled>Download as ZIP</button>
    
    <div class="loading" id="bulk-loading">
      <div class="spinner"></div>
      <div id="bulk-progress">Generating QR codes: 0/0</div>
    </div>
    
    <div class="success" id="bulk-success"></div>
    <div class="error" id="bulk-error"></div>
  </div>
  
  <!-- Scan QR Code Tab -->
  <div class="tab-content" id="scan-tab">
    <h2>QR Code Scanner</h2>
    
    <div class="scanner-container">
      <video id="scanner-video"></video>
      <div class="scanner-overlay" id="scanner-overlay">
        <div class="scanner-box"></div>
      </div>
    </div>
    
    <button id="start-scan">Start Scanner</button>
    <button id="stop-scan">Stop Scanner</button>
    
    <div class="scan-result" id="scan-result">
      <p>Scan results will appear here</p>
    </div>
  </div>
  
  <hr style="margin: 2em auto; width: 80%; border: 0; border-top: 1px solid #ddd;" />
  
  <!-- Sister Sites Section -->
  <div class="sister-tools-section">
    <h2>Try Our Other Free Tools</h2>
    <p>All our tools process your data entirely in your browser, ensuring your files are never stored or uploaded, keeping your privacy completely secure.</p>
    <a href="https://www.free-image-toolkit.com" target="_blank" rel="noopener noreferrer" class="sister-site-btn">
      Free Image Toolkit
    </a>
    <a href="https://www.free-video-toolkit.com" target="_blank" rel="noopener noreferrer" class="sister-site-btn">
      Free Video Toolkit
    </a>
    <a href="https://www.free-ean-maker.com" target="_blank" rel="noopener noreferrer" class="sister-site-btn">
      Free Barcode Generator
    </a>
  </div>
  
  <footer>
    Free QR Maker. Made with ❤️
  </footer>
  
  <script>
    // DOM Elements
    const qrInput = document.getElementById('qr-input');
    const qrCanvas = document.getElementById('qr-canvas');
    const fgColor = document.getElementById('fg-color');
    const bgColor = document.getElementById('bg-color');
    const sizeSlider = document.getElementById('size-slider');
    const sizeValue = document.getElementById('size-value');
    const logoUpload = document.getElementById('logo-upload');
    const logoPreview = document.getElementById('logo-preview');
    const qrLoading = document.getElementById('qr-loading');
    const qrError = document.getElementById('qr-error');
    const qrSuccess = document.getElementById('qr-success');
    const downloadBtn = document.getElementById('download-btn');
    const historyList = document.getElementById('history-list');
    const historyError = document.getElementById('history-error');
    const video = document.getElementById('scanner-video');
    const scanResult = document.getElementById('scan-result');
    const startScanBtn = document.getElementById('start-scan');
    const stopScanBtn = document.getElementById('stop-scan');
    const scannerOverlay = document.getElementById('scanner-overlay');
    const tabs = document.querySelectorAll('.tab');
    const tabContents = document.querySelectorAll('.tab-content');
    const bulkInput = document.getElementById('bulk-input');
    const bulkFilename = document.getElementById('bulk-filename');
    const downloadBulkBtn = document.getElementById('download-bulk');
    const bulkLoading = document.getElementById('bulk-loading');
    const bulkProgress = document.getElementById('bulk-progress');
    const bulkSuccess = document.getElementById('bulk-success');
    const bulkError = document.getElementById('bulk-error');
    
    // State variables
    let currentStream = null;
    let logoImage = null;
    let generatedQR = null;
    let history = JSON.parse(localStorage.getItem('qrHistory')) || [];
    let bulkQRs = [];
    
    // Initialize
    document.addEventListener('DOMContentLoaded', () => {
      updateSizeValue();
      loadHistory();
      
      // Tab switching
      tabs.forEach(tab => {
        tab.addEventListener('click', () => {
          tabs.forEach(t => t.classList.remove('active'));
          tabContents.forEach(c => c.classList.remove('active'));
          tab.classList.add('active');
          document.getElementById(`${tab.dataset.tab}-tab`).classList.add('active');
        });
      });
      
      // Size slider
      sizeSlider.addEventListener('input', updateSizeValue);
      
      // Logo upload
      logoUpload.addEventListener('change', handleLogoUpload);
      
      // Auto-detect URL
      qrInput.addEventListener('blur', autoFormatURL);
      
      // Scanner controls
      startScanBtn.addEventListener('click', startScanner);
      stopScanBtn.addEventListener('click', stopScanner);
      
      // Generate on Enter key
      qrInput.addEventListener('keypress', function(e) {
        if (e.key === 'Enter') {
          generateQR();
        }
      });
    });
    
    // Update size value display
    function updateSizeValue() {
      sizeValue.textContent = `${sizeSlider.value}px`;
    }
    
    // Handle logo upload
    function handleLogoUpload(e) {
      const file = e.target.files[0];
      if (!file) return;
      
      const reader = new FileReader();
      reader.onload = function(event) {
        logoImage = new Image();
        logoImage.onload = function() {
          logoPreview.innerHTML = '';
          const img = document.createElement('img');
          img.src = event.target.result;
          logoPreview.appendChild(img);
        };
        logoImage.src = event.target.result;
      };
      reader.readAsDataURL(file);
    }
    
    // Auto-format URL
    function autoFormatURL() {
      const input = qrInput.value.trim();
      if (!input) return;
      
      // Check if it looks like a URL but missing protocol
      if (input.includes('.') && !input.startsWith('http://') && !input.startsWith('https://')) {
        qrInput.value = `https://${input}`;
      }
    }
    
    // Generate QR Code
    function generateQR() {
      const input = qrInput.value.trim();
      if (!input) {
        showError(qrError, 'Please enter some content for the QR code');
        return;
      }
      
      // Show loading
      qrLoading.style.display = 'block';
      qrError.style.display = 'none';
      qrSuccess.style.display = 'none';
      downloadBtn.style.display = 'none';
      
      setTimeout(() => {
        try {
          const size = parseInt(sizeSlider.value);
          qrCanvas.width = size;
          qrCanvas.height = size;
          
          const ctx = qrCanvas.getContext('2d');
          ctx.clearRect(0, 0, size, size);
          
          // Generate QR code
          QRCode.toCanvas(qrCanvas, input, {
            width: size,
            margin: 1,
            color: {
              dark: fgColor.value,
              light: bgColor.value
            }
          }, function(error) {
            if (error) {
              showError(qrError, 'Error generating QR code: ' + error.message);
              qrLoading.style.display = 'none';
              return;
            }
            
            // Add logo if exists
            if (logoImage) {
              const logoSize = size / 4;
              const logoX = (size - logoSize) / 2;
              const logoY = (size - logoSize) / 2;
              
              // Draw white background for logo
              ctx.fillStyle = bgColor.value;
              ctx.fillRect(logoX - 2, logoY - 2, logoSize + 4, logoSize + 4);
              
              // Draw logo
              ctx.drawImage(logoImage, logoX, logoY, logoSize, logoSize);
            }
            
            // Store generated QR data URL
            generatedQR = qrCanvas.toDataURL('image/png');
            
            // Add to history
            addToHistory(input);
            
            // Show success and download button
            qrLoading.style.display = 'none';
            qrSuccess.style.display = 'block';
            qrSuccess.textContent = 'QR Code generated successfully!';
            downloadBtn.style.display = 'block';
            qrCanvas.style.display = 'block';
          });
        } catch (error) {
          showError(qrError, 'Error: ' + error.message);
          qrLoading.style.display = 'none';
        }
      }, 300);
    }
    
    // Download QR Code
    function downloadQR() {
      if (!generatedQR) {
        showError(qrError, 'Please generate a QR code first');
        return;
      }
      
      const a = document.createElement('a');
      a.href = generatedQR;
      a.download = 'qr-code.png';
      document.body.appendChild(a);
      a.click();
      document.body.removeChild(a);
    }
    
    // Add to history
    function addToHistory(content) {
      const historyItem = {
        content: content,
        timestamp: new Date().toISOString(),
        date: new Date().toLocaleString()
      };
      
      // Add to beginning of history
      history.unshift(historyItem);
      
      // Limit to 10 items
      if (history.length > 10) {
        history.pop();
      }
      
      // Save to localStorage
      localStorage.setItem('qrHistory', JSON.stringify(history));
      
      // Update UI
      loadHistory();
    }
    
    // Load history
    function loadHistory() {
      historyList.innerHTML = '';
      
      if (history.length === 0) {
        historyError.style.display = 'block';
        return;
      }
      
      historyError.style.display = 'none';
      
      history.forEach((item, index) => {
        const historyItem = document.createElement('div');
        historyItem.className = 'history-item';
        historyItem.innerHTML = `
          <div class="history-content">${item.content}</div>
          <div class="history-date">${item.date}</div>
        `;
        
        historyItem.addEventListener('click', () => {
          qrInput.value = item.content;
          generateQR();
        });
        
        historyList.appendChild(historyItem);
      });
    }
    
    // Clear history
    function clearHistory() {
      history = [];
      localStorage.removeItem('qrHistory');
      loadHistory();
    }
    
    // Start scanner
    function startScanner() {
      scannerOverlay.style.display = 'flex';
      scanResult.innerHTML = '<p>Scanning... Point camera at a QR code</p>';
      
      navigator.mediaDevices.getUserMedia({ video: { facingMode: 'environment' } })
        .then(stream => {
          currentStream = stream;
          video.srcObject = stream;
          video.play();
          
          requestAnimationFrame(scanQR);
        })
        .catch(err => {
          console.error('Camera error: ', err);
          scanResult.innerHTML = `<p class="error">Error accessing camera: ${err.message}</p>`;
        });
    }
    
    // Stop scanner
    function stopScanner() {
      if (currentStream) {
        currentStream.getTracks().forEach(track => track.stop());
        currentStream = null;
      }
      scannerOverlay.style.display = 'none';
    }
    
    // Scan QR Code
    function scanQR() {
      if (!currentStream) return;
      
      if (video.readyState === video.HAVE_ENOUGH_DATA) {
        const canvas = document.createElement('canvas');
        const ctx = canvas.getContext('2d');
        canvas.width = video.videoWidth;
        canvas.height = video.videoHeight;
        
        ctx.drawImage(video, 0, 0, canvas.width, canvas.height);
        const imageData = ctx.getImageData(0, 0, canvas.width, canvas.height);
        const code = jsQR(imageData.data, imageData.width, imageData.height);
        
        if (code) {
          scanResult.innerHTML = `
            <p><strong>QR Code detected!</strong></p>
            <p><strong>Content:</strong> ${code.data}</p>
            <button onclick="useScannedContent('${code.data.replace(/'/g, "\\'")}')">
              Generate this QR
            </button>
          `;
        }
      }
      
      requestAnimationFrame(scanQR);
    }
    
    // Use scanned content
    function useScannedContent(content) {
      stopScanner();
      qrInput.value = content;
      tabs[0].click();
      generateQR();
    }
    
    // Generate bulk QR codes
    function generateBulkQR() {
      const inputs = bulkInput.value.trim().split('\n').filter(line => line.trim() !== '');
      
      if (inputs.length === 0) {
        showError(bulkError, 'Please enter at least one item');
        return;
      }
      
      if (inputs.length > 50) {
        showError(bulkError, 'For performance reasons, please limit to 50 items at once');
        return;
      }
      
      // Reset state
      bulkQRs = [];
      downloadBulkBtn.disabled = true;
      bulkSuccess.style.display = 'none';
      bulkError.style.display = 'none';
      bulkLoading.style.display = 'block';
      
      // Process in batches
      processBulkBatch(inputs, 0);
    }
    
    // Process bulk batch
    function processBulkBatch(inputs, index) {
      if (index >= inputs.length) {
        // Finished
        bulkLoading.style.display = 'none';
        bulkSuccess.style.display = 'block';
        bulkSuccess.textContent = `Successfully generated ${bulkQRs.length} QR codes!`;
        downloadBulkBtn.disabled = false;
        return;
      }
      
      // Update progress
      bulkProgress.textContent = `Generating QR codes: ${index + 1}/${inputs.length}`;
      
      const input = inputs[index];
      const canvas = document.createElement('canvas');
      canvas.width = 256;
      canvas.height = 256;
      
      try {
        QRCode.toCanvas(canvas, input, {
          width: 256,
          margin: 1,
          color: {
            dark: fgColor.value,
            light: bgColor.value
          }
        }, function(error) {
          if (error) {
            console.error('Error generating QR for: ' + input, error);
          } else {
            bulkQRs.push({
              content: input,
              dataURL: canvas.toDataURL('image/png')
            });
          }
          
          // Process next
          setTimeout(() => processBulkBatch(inputs, index + 1), 50);
        });
      } catch (error) {
        console.error('Error generating QR for: ' + input, error);
        setTimeout(() => processBulkBatch(inputs, index + 1), 50);
      }
    }
    
    // Download bulk QR codes as ZIP
    downloadBulkBtn.addEventListener('click', () => {
      if (bulkQRs.length === 0) {
        showError(bulkError, 'No QR codes to download. Please generate first.');
        return;
      }
      
      bulkLoading.style.display = 'block';
      bulkProgress.textContent = 'Creating ZIP file...';
      
      setTimeout(() => {
        try {
          const zip = new JSZip();
          const prefix = bulkFilename.value.trim() || 'qr-codes';
          
          bulkQRs.forEach((item, index) => {
            const filename = `${prefix}-${index + 1}.png`;
            // Convert data URL to blob
            const data = item.dataURL.split(',')[1];
            zip.file(filename, data, { base64: true });
          });
          
          zip.generateAsync({ type: 'blob' }).then(content => {
            saveAs(content, `${prefix}.zip`);
            bulkLoading.style.display = 'none';
          });
        } catch (error) {
          showError(bulkError, 'Error creating ZIP file: ' + error.message);
          bulkLoading.style.display = 'none';
        }
      }, 100);
    });
    
    // Helper to show error
    function showError(element, message) {
      element.textContent = message;
      element.style.display = 'block';
    }
  </script>
</body>
</html>
